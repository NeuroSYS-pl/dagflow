<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.5">
<title data-react-helmet="true">Sequential | MAGDA</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://NeuroSYS-pl.github.io/magda/docs/next/pipelines/sequential/"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Sequential | MAGDA"><meta data-react-helmet="true" name="description" content="The first type of a pipeline is a Sequential Pipeline. The other, more complex one is a Parallel Pipeline, which is in fact just multiple sequential pipelines running in parallel."><meta data-react-helmet="true" property="og:description" content="The first type of a pipeline is a Sequential Pipeline. The other, more complex one is a Parallel Pipeline, which is in fact just multiple sequential pipelines running in parallel."><link data-react-helmet="true" rel="canonical" href="https://NeuroSYS-pl.github.io/magda/docs/next/pipelines/sequential/"><link data-react-helmet="true" rel="alternate" href="https://NeuroSYS-pl.github.io/magda/docs/next/pipelines/sequential/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://NeuroSYS-pl.github.io/magda/docs/next/pipelines/sequential/" hreflang="x-default"><link rel="stylesheet" href="/magda/assets/css/styles.369f8454.css">
<link rel="preload" href="/magda/assets/js/runtime~main.434a9ea3.js" as="script">
<link rel="preload" href="/magda/assets/js/main.be521564.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/magda/"><b class="navbar__title">MAGDA üëß</b></a><a class="navbar__item navbar__link navbar__link--active" href="/magda/docs/next/home/">Guides</a><a href="https://github.com/NeuroSYS-pl/magda/tree/main/examples" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Examples<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" href="/magda/docs/next/home/">Next</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link navbar__link--active" href="/magda/docs/next/pipelines/sequential/">Next</a></li><li><a class="dropdown__link" href="/magda/docs/pipelines/sequential/">0.1</a></li></ul></div><a href="https://github.com/NeuroSYS-pl/magda" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">üåû</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/magda/docs/next/home/">What is MAGDA?</a></li><li class="menu__list-item"><a class="menu__link" href="/magda/docs/next/quick-start/">Quick Start ‚è±Ô∏è</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Modules</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Pipelines</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/magda/docs/next/pipelines/sequential/">Sequential</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/magda/docs/next/pipelines/parallel/">Parallel</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/magda/docs/next/pipelines/parallel-actor-pool/">Actor Pool</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Configuration</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for MAGDA <b>Next</b> version.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/magda/docs/pipelines/sequential/">latest version</a></b> (0.1).</div></div><div class="docItemContainer_33ec"><article><span class="badge badge--secondary">Version: Next</span><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1>Sequential Pipeline</h1></header><p>The first type of a pipeline is a <em>Sequential Pipeline</em>. The other, more complex one is a <em>Parallel Pipeline</em>, which is in fact just multiple sequential pipelines running in parallel. </p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="overview"></a>Overview<a class="hash-link" href="#overview" title="Direct link to heading">#</a></h2><p>A <em>Pipeline</em> is composed of a set of <em>Modules</em>. It&#x27;s a manager for creating and controlling the flow throughout <em>DAG</em> (<em>Directed Acyclic Graph</em>).</p><p>Like <em>Modules</em>, a <em>Pipeline</em> can be in one of two distinct states:</p><ul><li><p><strong>Builder</strong><br>
is responsible for constructing a graph of modules and then sorting it,</p></li><li><p><strong>Execution</strong><br>
is tasked with the execution of proper modules via <code>run</code> or <code>process</code> methods, which are described in detail <a href="/magda/docs/next/modules/stateful/#pipeline-modes">here</a>.</p></li></ul><p>Additionally, a pipeline may be also closed by running <code>close</code> function on the runtime object. Closing a module results in calling <code>teardown</code> method for each module. A closed pipeline cannot be rerun. </p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="directed-acyclic-graph"></a>Directed Acyclic Graph<a class="hash-link" href="#directed-acyclic-graph" title="Direct link to heading">#</a></h2><p>When invoking <code>Pipeline.build</code> a <em>Graph</em>, consisting of all modules previously added to a sequential pipeline, is built.
Before a <code>Module</code> is run <strong>all of it&#x27;s dependencies</strong> have to be completed. In order for the <code>Module</code> to be run as soon as possible all <em>Modules</em> are sorted.</p><p>MAGDA <em>Graph</em> employs <strong>topological sorting</strong>. It&#x27;s a graph ordering algorithm which is viable only when the graph is directed and doesn&#x27;t have any cycles.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="disallowed-circular-dependencies"></a>Disallowed circular dependencies<a class="hash-link" href="#disallowed-circular-dependencies" title="Direct link to heading">#</a></h3><svg xmlns="http://www.w3.org/2000/svg" width="30%" height="152" viewBox="-0.5 -0.5 422 152" class="diagram"><defs><style>@import url(https://fonts.googleapis.com/css?family=Roboto);</style></defs><path d="M90 50h71.76" fill="none" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M167.76 50l-8 4 2-4-2-4z" fill="#b85450" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M10 10h80v80H10z"></path><text x="49.5" y="63.5" font-family="Roboto" text-anchor="middle" font-size="32">A</text><path d="M250 50h71.76" fill="none" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M327.76 50l-8 4 2-4-2-4z" fill="#b85450" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M170 10h80v80h-80z"></path><text x="209.5" y="63.5" font-family="Roboto" text-anchor="middle" font-size="32">B</text><path d="M370 90v20q0 20-20 20H70q-20 0-20-15.88V98.24" fill="none" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M50 92.24l4 8-4-2-4 2z" fill="#b85450" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M330 10h80v80h-80z"></path><text x="369.5" y="63.5" font-family="Roboto" text-anchor="middle" font-size="32">C</text></svg><p>Topological sorting orders the modules resulting in the sequence where every module follows its dependent modules. The algorithm prioritizes the execution of <em>Modules</em> that either have no dependencies or are essential for the next <code>Module</code> to be run as soon as possible.</p><p><em>MAGDA</em> works on basis of a <strong>single connected graph</strong>, so bear in mind that the pipeline cannot consist of multiple disjoint subgraphs. All the modules need to be connected.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="disallowed-disjoint-graphs-definition"></a>Disallowed disjoint graphs definition<a class="hash-link" href="#disallowed-disjoint-graphs-definition" title="Direct link to heading">#</a></h3><svg xmlns="http://www.w3.org/2000/svg" width="30%" height="282" viewBox="-0.5 -0.5 422 282" class="diagram"><defs><style>@import url(https://fonts.googleapis.com/css?family=Roboto);</style></defs><path d="M90 110h71.76" fill="none" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M167.76 110l-8 4 2-4-2-4z" fill="#b85450" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M10 70h80v80H10z"></path><text x="49.5" y="123.5" font-family="Roboto" text-anchor="middle" font-size="32">A</text><path d="M250 110h20q20 0 20-20V70q0-20 15.88-20h15.88" fill="none" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M327.76 50l-8 4 2-4-2-4z" fill="#b85450" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M250 110h20q20 0 20 20v20q0 20 15.88 20h15.88" fill="none" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M327.76 170l-8 4 2-4-2-4z" fill="#b85450" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M170 70h80v80h-80z"></path><text x="209.5" y="123.5" font-family="Roboto" text-anchor="middle" font-size="32">B</text><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M330 10h80v80h-80z"></path><text x="369.5" y="63.5" font-family="Roboto" text-anchor="middle" font-size="32">C</text><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M330 130h80v80h-80z"></path><text x="369.5" y="183.5" font-family="Roboto" text-anchor="middle" font-size="32">D</text><path d="M90 230h71.76" fill="none" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M167.76 230l-8 4 2-4-2-4z" fill="#b85450" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M10 190h80v80H10z"></path><text x="49.5" y="243.5" font-family="Roboto" text-anchor="middle" font-size="32">E</text><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M170 190h80v80h-80z"></path><text x="209.5" y="243.5" font-family="Roboto" text-anchor="middle" font-size="32">F</text></svg><p>During the pipeline building both disjoint graphs and circular dependencies are checked for, which result in appropriate errors if found.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="sequential-pipeline-flow"></a>Sequential Pipeline flow<a class="hash-link" href="#sequential-pipeline-flow" title="Direct link to heading">#</a></h3><p>Once the pipeline is built and modules are in the correct order, it can be run. As the name of the pipeline suggests, the modules are called in a <strong>sequence</strong>.</p><p>Given the example below, <em>MAGDA</em> guarantees that module <em>A</em> will be run first after which either <em>B</em> or <em>C</em> is run and then module <em>D</em> as the last one. Both  <em>A -&gt; B -&gt; C -&gt; D</em> and <em>A -&gt; C -&gt; B -&gt; D</em> are possible run sequences. In this case, it doesn&#x27;t really matter whether module <em>B</em> or <em>C</em> runs first. What&#x27;s important, modules <em>B</em> and <em>C</em> won&#x27;t run in parallel here (though it could be achieved with the usage of a <a href="/magda/docs/next/pipelines/parallel/">Parallel Pipeline</a>)</p><svg xmlns="http://www.w3.org/2000/svg" width="30%" height="262" viewBox="-0.5 -0.5 422 262" class="diagram"><defs><style>@import url(https://fonts.googleapis.com/css?family=Roboto);</style></defs><path d="M90 130h20q20 0 20-20V70q0-20 15.88-20h15.88" fill="none" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M167.76 50l-8 4 2-4-2-4z" fill="#b85450" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M90 130h20q20 0 20 20v40q0 20 15.88 20h15.88" fill="none" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M167.76 210l-8 4 2-4-2-4z" fill="#b85450" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M10 90h80v80H10z"></path><text x="49.5" y="143.5" font-family="Roboto" text-anchor="middle" font-size="32">A</text><path d="M250 50h20q20 0 20 20v20q0 20 15.88 20h15.88" fill="none" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M327.76 110l-8 4 2-4-2-4z" fill="#b85450" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M170 10h80v80h-80z"></path><text x="209.5" y="63.5" font-family="Roboto" text-anchor="middle" font-size="32">B</text><path d="M250 210h20q20 0 20-20v-20q0-20 15.88-20h15.88" fill="none" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M327.76 150l-8 4 2-4-2-4z" fill="#b85450" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M170 170h80v80h-80z"></path><text x="209.5" y="223.5" font-family="Roboto" text-anchor="middle" font-size="32">C</text><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M330 90h80v80h-80z"></path><text x="369.5" y="143.5" font-family="Roboto" text-anchor="middle" font-size="32">D</text></svg><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="technical-details"></a>Technical details<a class="hash-link" href="#technical-details" title="Direct link to heading">#</a></h2><p>The schematic creation of a sequential pipeline is as follows:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> magda</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pipeline </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> SequentialPipeline</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Building a pipeline</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">builder </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SequentialPipeline</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_module</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">runtime </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">build</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Running the pipeline</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">runtime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">runtime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">process</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="simple-case-study"></a>Simple case study<a class="hash-link" href="#simple-case-study" title="Direct link to heading">#</a></h2><p>Here is presented a very simple example of a pipeline usage. For more complex examples see <a href="#blueprints">the next section</a>. </p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="creating-a-pipeline-instance"></a>Creating a pipeline instance<a class="hash-link" href="#creating-a-pipeline-instance" title="Direct link to heading">#</a></h3><p>In order for the pipeline to be built and run, it must consist of modules. Having implemented <code>Module</code> classes, the modules need to be added to the pipeline instance. This can be achieved with the use of a configuration file or manually from code. For in-depth workflow please refer to <a href="/magda/docs/next/modules/workflow/">workflow</a>.</p><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1uMI tabs__item--active">Code-first</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_1uMI">Config-first</li></ul><div class="margin-vert--md"><div role="tabpanel"><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> magda</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pipeline </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> SequentialPipeline</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">builder </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SequentialPipeline</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_module</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SomeModule</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;module_a&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_module</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SomeOtherModule</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;module_b&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">depends_on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_module</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;module_a&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">runtime </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">build</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>To avoid using the <code>builder.get_module</code> method, the module can be instantiated outside of the pipeline. This way adding modules, through object references, gets more transparent. The following snippet does exactly the same as the one above.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> magda</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pipeline </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> SequentialPipeline</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">module_a </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SomeModule</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;module_a&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">module_b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SomeOtherModule</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;module_b&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">builder </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SequentialPipeline</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_module</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_module</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_b</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">depends_on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">runtime </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">build</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><div role="tabpanel" hidden=""><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">modules</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> module_a</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> some</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">module</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> module_b</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> some</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">other</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">module</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">depends_on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> module_a</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The config file is then read, creating a pipeline instance (assuming modules have been registered in the <code>ModuleFactory</code> either manually or via the <code>@register</code> decorator). </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">runtime </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ConfigReader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config_file_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ModuleFactory</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>It&#x27;s worth noting that the <code>ConfigReader.read</code> method outputs an already built pipeline. It means that first the pipeline is created, modules are added, some additional options and parameters are set, and at the end the <code>pipeline.build</code> method is invoked.
It&#x27;s important to know how it works as during pipeline building the <code>bootstrap</code> method in every module is called, which is described in detail <a href="/magda/docs/next/modules/module/">here</a>.</p></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="running-the-pipeline"></a>Running the pipeline<a class="hash-link" href="#running-the-pipeline" title="Direct link to heading">#</a></h3><p>The <em>Pipeline</em> can work in one of two modes: run or process, which are described in detail <a href="/magda/docs/next/modules/stateful/">here</a>. In brief, the run mode sequentially calls the <code>run</code> method in every <code>Module.Runtime</code> from the <em>Graph</em> (which precedes an aggregation module) and the <code>aggregate</code> method from the <code>Module.Aggregate</code>. All <code>Module.Runtime</code> following <code>Module.Aggregate</code> are ommited.</p><p>During the process mode firstly <code>process</code> methods from the aggregation modules are called, which return stored data. Then the <code>run</code> method from every runtime module (that succeeds the aggregation module) is invoked. All <code>Module.Runtime</code> preceding <code>Module.Aggregate</code> are ommited.</p><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Notice</h5></div><div class="admonition-content"><p>Every invocation of the <code>pipeline.process</code> method clears aggregation modules inner state.</p></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># during both `run` and `process` modes requests can be passed to the pipeline</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">process</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic"># aggregation module inner state contains 2 elements</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">process</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic"># aggregation module inner state contains only 1 element</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="blueprints"></a>Blueprints<a class="hash-link" href="#blueprints" title="Direct link to heading">#</a></h2><p>In the following section, instead of very specific implementations, general blueprints for creating a <code>SequentialPipeline</code> are shown. These are working examples with abstracted naming and logic, which can be easily expanded on with concrete details.
The examples will be also briefly commented on how they work and what should be an expected outcome of each one.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="a-stateless-pipeline-based-only-on-moduleruntime"></a>A stateless pipeline based only on <code>Module.Runtime</code><a class="hash-link" href="#a-stateless-pipeline-based-only-on-moduleruntime" title="Direct link to heading">#</a></h3><p>Consider the following pipeline:</p><svg xmlns="http://www.w3.org/2000/svg" width="50%" height="262" viewBox="-0.5 -0.5 582 262" class="diagram"><defs><style>@import url(https://fonts.googleapis.com/css?family=Roboto);</style></defs><path d="M90 50h20q20 0 20 20v20q0 20 15.88 20h15.88" fill="none" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M167.76 110l-8 4 2-4-2-4z" fill="#b85450" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M10 10h80v80H10z"></path><text x="49.5" y="63.5" font-family="Roboto" text-anchor="middle" font-size="32">A</text><path d="M90 210h20q20 0 20-20v-20q0-20 15.88-20h15.88" fill="none" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M167.76 150l-8 4 2-4-2-4z" fill="#b85450" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M10 170h80v80H10z"></path><text x="49.5" y="223.5" font-family="Roboto" text-anchor="middle" font-size="32">B</text><path d="M250 130h231.76" fill="none" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M487.76 130l-8 4 2-4-2-4z" fill="#b85450" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M250 130h20q20 0 20-20V70q0-20 15.88-20h15.88" fill="none" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M327.76 50l-8 4 2-4-2-4z" fill="#b85450" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M250 130h20q20 0 20 20v40q0 20 15.88 20h15.88" fill="none" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M327.76 210l-8 4 2-4-2-4z" fill="#b85450" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M170 90h80v80h-80z"></path><text x="209.5" y="143.5" font-family="Roboto" text-anchor="middle" font-size="32">C</text><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M330 10h80v80h-80z"></path><text x="369.5" y="63.5" font-family="Roboto" text-anchor="middle" font-size="32">D</text><path d="M410 210h20q20 0 20-20v-20q0-20 15.88-20h15.88" fill="none" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M487.76 150l-8 4 2-4-2-4z" fill="#b85450" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M330 170h80v80h-80z"></path><text x="369.5" y="223.5" font-family="Roboto" text-anchor="middle" font-size="32">E</text><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M490 90h80v80h-80z"></path><text x="529.5" y="143.5" font-family="Roboto" text-anchor="middle" font-size="32">F</text></svg><p>The code is divided into six distinct sections.</p><p>1) <strong>Class definitions</strong><br>
This is where all classes are defined. Notice that, since the classes are added manually to the pipeline, neither the <code>@register</code> decorator nor <code>ModuleFactory</code> was used.</p><details class="details_2Ziz alert alert--info details_1VDD" data-collapsed="true"><summary>See code snippet</summary><div><div class="collapsibleContent_3OHp"><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> magda</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">module </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Module</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> magda</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">decorators </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> accept</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> finalize</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> expose</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> magda</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pipeline </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> SequentialPipeline</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@finalize</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ModuleA</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Runtime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;module a output&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@finalize</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ModuleB</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Runtime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;module b output&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@accept</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ModuleA</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ModuleB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@finalize</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ModuleC</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Runtime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;module c output&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@accept</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ModuleC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@expose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@finalize</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ModuleD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Runtime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">parameters</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;important_parameter&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@accept</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ModuleC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@finalize</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ModuleE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Runtime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;module e output&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@accept</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ModuleC</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ModuleE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@expose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;module_f_expose_name&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@finalize</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ModuleF</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Runtime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;module f output&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div></div></details><p>2) <strong>Module initialization</strong><br>
Here every module is initialized and a name is set through the constructor. This name is used for <code>@exposed</code> classes that don&#x27;t have an explicit expose name.</p><details class="details_2Ziz alert alert--info details_1VDD" data-collapsed="true"><summary>See code snippet</summary><div><div class="collapsibleContent_3OHp"><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">module_a </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ModuleA</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;module_a&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">module_b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ModuleB</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;module_b&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">module_c </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ModuleC</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;module_c&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">module_d </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ModuleD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;module_d&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">module_e </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ModuleE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;module_e&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">module_f </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ModuleF</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;module_f&#x27;</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div></div></details><p>3) <strong>Dependency and parameters definition</strong><br>
Here all dependencies and additional module parameters should be configured. Thanks to module initialization in the 2nd step, now <strong>it is possible to directly reference modules inside the <code>depends_on</code> function.</strong></p><details class="details_2Ziz alert alert--info details_1VDD" data-collapsed="true"><summary>See code snippet</summary><div><div class="collapsibleContent_3OHp"><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">module_c</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">depends_on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">depends_on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">module_d</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">depends_on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">module_e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">depends_on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">module_f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">depends_on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">depends_on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">module_d</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_parameters</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;important_parameter&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ModuleD important output&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div></div></details><p>4) <strong>Adding modules to a pipeline</strong><br>
Here every initiated module is added to the pipeline. If the class didn&#x27;t inherit from either <code>Module.Runtime</code> or <code>Module.Aggregate</code> an error is raised.</p><details class="details_2Ziz alert alert--info details_1VDD" data-collapsed="true"><summary>See code snippet</summary><div><div class="collapsibleContent_3OHp"><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">builder </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SequentialPipeline</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_module</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_module</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_module</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_module</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_d</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_module</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_module</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_f</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div></div></details><p>5) <strong>Pipeline build</strong><br>
During pipeline <code>build</code>, firstly, a Graph is built and validated for cycles and disjoint graphs. If the validation passes then all previously added modules are bootstrapped. If there is any <code>context</code> or <code>shared_parameters</code> available they can be added as optional pipeline <code>build</code> parameters.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">runtime </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">build</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>6) <strong>Pipeline running</strong><br>
When a pipeline is built it is ready to be run. As stated before, there are two ways to execute a pipeline. Here, since there is no <code>Module.Aggregate</code> inside a pipeline only the <code>run</code> option is applicable. The <code>run</code> can also accept a <code>request</code> parameter that could be used throughout the pipeline. Since <code>ModuleD</code> and <code>ModuleF</code> are exposed their results will be available as the pipeline results after a completed <code>run</code> function.<br>
<code>ModuleD</code>&#x27;s result is available under the name it was initialized (&quot;module_d&quot;), but because there was a name passed to <code>@expose</code> when defining <code>ModuleF</code> class it was used instead (&quot;module_f_expose_name&quot;). Also, <code>ModuleD</code> makes use of passed module parameters (via <code>self.parameters</code>), which it just returns. All possible parameters and how to properly use them are explained in detail <a href="/magda/docs/next/modules/module/">here</a>.</p><details class="details_2Ziz alert alert--info details_1VDD" data-collapsed="true"><summary>See code snippet</summary><div><div class="collapsibleContent_3OHp"><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> runtime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># {&#x27;module_f_expose_name&#x27;: &#x27;module f output&#x27;, &#x27;module_d&#x27;: &#x27;ModuleD important output&#x27;}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div></div></details><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="a-stateful-pipeline-based-on-both-moduleruntime-and-moduleaggregate"></a>A stateful pipeline based on both <code>Module.Runtime</code> and <code>Module.Aggregate</code><a class="hash-link" href="#a-stateful-pipeline-based-on-both-moduleruntime-and-moduleaggregate" title="Direct link to heading">#</a></h3><p>Below a blueprint for a pipeline that can hold a state in between runs is shown.
It has the same structure as the above one. Every step will be described but not as in depth.</p><p>Consider the following pipeline:</p><svg xmlns="http://www.w3.org/2000/svg" width="50%" height="262" viewBox="-0.5 -0.5 582 262" class="diagram"><defs><style>@import url(https://fonts.googleapis.com/css?family=Roboto);</style></defs><path d="M90 50h20q20 0 20 20v20q0 20 15.88 20h15.88" fill="none" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M167.76 110l-8 4 2-4-2-4z" fill="#b85450" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M10 10h80v80H10z"></path><text x="49.5" y="63.5" font-family="Roboto" text-anchor="middle" font-size="32">A</text><path d="M90 210h20q20 0 20-20v-20q0-20 15.88-20h15.88" fill="none" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M167.76 150l-8 4 2-4-2-4z" fill="#b85450" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M10 170h80v80H10z"></path><text x="49.5" y="223.5" font-family="Roboto" text-anchor="middle" font-size="32">B</text><path d="M250 130h20q20 0 20-20V70q0-20 15.88-20h15.88" fill="none" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M327.76 50l-8 4 2-4-2-4z" fill="#b85450" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M250 130h20q20 0 20 20v40q0 20 15.88 20h15.88" fill="none" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M327.76 210l-8 4 2-4-2-4z" fill="#b85450" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M170 90h80v80h-80z"></path><text x="209.5" y="143.5" font-family="Roboto" text-anchor="middle" font-size="32">C</text><path d="M410 50h71.76" fill="none" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M487.76 50l-8 4 2-4-2-4z" fill="#b85450" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M330 10h80v80h-80z"></path><text x="369.5" y="63.5" font-family="Roboto" text-anchor="middle" font-size="32">D</text><path d="M410 210h71.76" fill="none" stroke="#9673a6" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M487.76 210l-8 4 2-4-2-4z" fill="#9673a6" stroke="#9673a6" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#e1d5e7" stroke="#9673a6" stroke-width="2" pointer-events="all" d="M330 170h80v80h-80z"></path><text x="369.5" y="223.5" font-family="Roboto" text-anchor="middle" font-size="32">F</text><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M490 10h80v80h-80z"></path><text x="529.5" y="63.5" font-family="Roboto" text-anchor="middle" font-size="32">E</text><path fill="#e1d5e7" stroke="#9673a6" stroke-width="2" pointer-events="all" d="M490 170h80v80h-80z"></path><text x="529.5" y="223.5" font-family="Roboto" text-anchor="middle" font-size="32">G</text><rect x="345" y="160" width="50" height="20" rx="10" ry="10" fill="#e1d5e7" stroke="#9673a6" stroke-width="2" pointer-events="all"></rect><text x="369.5" y="175.5" font-family="Roboto" font-weight="bold" text-anchor="middle" font-size="16">AGG</text></svg><p>The code is divided into six distinct sections.</p><p>1) <strong>Class definitions</strong><br>
All modules besides is defined as <code>Module.Runtime</code>, besides <code>ModuleF</code> which acts as <code>Module.Aggregate</code>.</p><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Notice</h5></div><div class="admonition-content"><p>The definition of <code>ModuleE</code> and <code>ModuleG</code> which have overridden run methods to also include <code>data</code> or <code>request</code> parameters. It can be done since these two parameters are always passed. Any other can be accessed through <code>args</code> or <code>kwargs</code>.</p></div></div><details class="details_2Ziz alert alert--info details_1VDD" data-collapsed="true"><summary>See code snippet</summary><div><div class="collapsibleContent_3OHp"><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> magda</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">module </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Module</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> magda</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">decorators </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> accept</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> finalize</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> expose</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> magda</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pipeline </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> SequentialPipeline</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@finalize</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ModuleA</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Runtime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;module a output&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@finalize</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ModuleB</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Runtime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;module b output&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@accept</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ModuleA</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ModuleB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@finalize</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ModuleC</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Runtime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;module c output&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@accept</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ModuleC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@finalize</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ModuleD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Runtime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;module d output&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@accept</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ModuleD</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@expose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@finalize</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ModuleE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Runtime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> request</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> request</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@accept</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ModuleC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@finalize</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ModuleF</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Aggregate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pass</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@accept</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ModuleF</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@expose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@finalize</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ModuleG</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Runtime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> data</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div></div></details><p>2) <strong>Module initialization</strong><br>
All modules have their appropriate name set. Even though <code>ModuleF</code> isn&#x27;t <code>Module.Runtime</code> it has the same initialization.</p><details class="details_2Ziz alert alert--info details_1VDD" data-collapsed="true"><summary>See code snippet</summary><div><div class="collapsibleContent_3OHp"><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">module_a </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ModuleA</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;module_a&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">module_b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ModuleB</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;module_b&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">module_c </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ModuleC</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;module_c&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">module_d </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ModuleD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;module_d&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">module_e </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ModuleE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;module_e&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">module_f </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ModuleF</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;module_f&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">module_g </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ModuleG</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;module_g&#x27;</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div></div></details><p>3) <strong>Dependency and parameters definition</strong><br>
As before, in order to create a graph all modules have to be connected.</p><details class="details_2Ziz alert alert--info details_1VDD" data-collapsed="true"><summary>See code snippet</summary><div><div class="collapsibleContent_3OHp"><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">module_c</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">depends_on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">depends_on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">module_d</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">depends_on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">module_e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">depends_on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_d</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">module_f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">depends_on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">module_g</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">depends_on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_f</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">    </span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div></div></details><p>4) <strong>Adding modules to a pipeline</strong><br>
Here every initiated module is added to the pipeline. If the class didn&#x27;t inherit from either <code>Module.Runtime</code> or <code>Module.Aggregate</code> an error is raised.</p><details class="details_2Ziz alert alert--info details_1VDD" data-collapsed="true"><summary>See code snippet</summary><div><div class="collapsibleContent_3OHp"><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">builder </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SequentialPipeline</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_module</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_module</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_module</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_module</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_d</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_module</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_module</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_f</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_module</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">module_g</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div></div></details><p>5) <strong>Pipeline build</strong><br>
The <code>context</code> parameter is a dictionary that can hold both primitive types or references as it&#x27;s values.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">runtime </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">build</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;context_1&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;context&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>6) <strong>Pipeline running</strong><br>
The pipeline is run in two states. Firstly the <code>run</code> is used twice to execute two requests. The pipeline has two ending branches. One that has exposed result via <code>ModuleE</code> and one via <code>ModuleG</code>. During both passes only the modules marked as yellow blocks have their <code>run</code> method executed. The request is also added to the internal state of <code>ModuleF</code> but no further modules are run.<br>
Afterwards, in order to retrieve and work with stored data, <code>process</code> mode is used. It executes <code>ModuleG</code> marked as a purple block after getting the collected results from <code>ModuleF</code>. The result is a <code>ResultSet</code> object containing all previously stored data, about which can be read more <a href="/magda/docs/next/modules/module/">here</a>.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Remember</h5></div><div class="admonition-content"><p>During <code>process</code> mode the other branch wasn&#x27;t executed.</p></div></div><details class="details_2Ziz alert alert--info details_1VDD" data-collapsed="true"><summary>See code snippet</summary><div><div class="collapsibleContent_3OHp"><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">result_run_1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> runtime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;request_1&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">result_run_2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> runtime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;request_2&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">result_process </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> runtime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">process</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result_run_1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># {&#x27;module_e&#x27;: &#x27;request_1&#x27;}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result_run_2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># {&#x27;module_e&#x27;: &#x27;request_2&#x27;}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result_process</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># {&#x27;module_g&#x27;: &lt;magda.module.results.ResultSet&gt;}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div></div></details></div><footer class="docusaurus-mt-lg"><div class="row"><div class="col"><a href="https://github.com/NeuroSYS-pl/magda/edit/main/web/docs/pipelines/sequential.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/magda/docs/next/modules/stateful/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ Stateful Modules</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/magda/docs/next/pipelines/parallel/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Parallel ¬ª</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link">Overview</a></li><li><a href="#directed-acyclic-graph" class="table-of-contents__link">Directed Acyclic Graph</a><ul><li><a href="#disallowed-circular-dependencies" class="table-of-contents__link">Disallowed circular dependencies</a></li><li><a href="#disallowed-disjoint-graphs-definition" class="table-of-contents__link">Disallowed disjoint graphs definition</a></li><li><a href="#sequential-pipeline-flow" class="table-of-contents__link">Sequential Pipeline flow</a></li></ul></li><li><a href="#technical-details" class="table-of-contents__link">Technical details</a></li><li><a href="#simple-case-study" class="table-of-contents__link">Simple case study</a><ul><li><a href="#creating-a-pipeline-instance" class="table-of-contents__link">Creating a pipeline instance</a></li><li><a href="#running-the-pipeline" class="table-of-contents__link">Running the pipeline</a></li></ul></li><li><a href="#blueprints" class="table-of-contents__link">Blueprints</a><ul><li><a href="#a-stateless-pipeline-based-only-on-moduleruntime" class="table-of-contents__link">A stateless pipeline based only on <code>Module.Runtime</code></a></li><li><a href="#a-stateful-pipeline-based-on-both-moduleruntime-and-moduleaggregate" class="table-of-contents__link">A stateful pipeline based on both <code>Module.Runtime</code> and <code>Module.Aggregate</code></a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://neurosys.com/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_MyFc"><img src="https://neurosys.com/wp-content/themes/neurosys/static/images/logo-white.svg" alt="NeuroSYS" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="https://neurosys.com/wp-content/themes/neurosys/static/images/logo-white.svg" alt="NeuroSYS" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></a></div><div class="footer__copyright">Copyright ¬© 2021 NeuroSYS, Built with Docusaurus.</div></div></div></footer></div>
<script src="/magda/assets/js/runtime~main.434a9ea3.js"></script>
<script src="/magda/assets/js/main.be521564.js"></script>
</body>
</html>