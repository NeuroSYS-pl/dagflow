<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.5">
<title data-react-helmet="true">Stateful Modules | MAGDA</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://NeuroSYS-pl.github.io/magda/docs/next/modules/stateful/"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Stateful Modules | MAGDA"><meta data-react-helmet="true" name="description" content="So far only regular stateless modules were described. Stateless because they don&#x27;t store any data between requests. Even though they have their advantages, sometimes there is a need to remember some information after every pipeline.run excecution."><meta data-react-helmet="true" property="og:description" content="So far only regular stateless modules were described. Stateless because they don&#x27;t store any data between requests. Even though they have their advantages, sometimes there is a need to remember some information after every pipeline.run excecution."><link data-react-helmet="true" rel="canonical" href="https://NeuroSYS-pl.github.io/magda/docs/next/modules/stateful/"><link data-react-helmet="true" rel="alternate" href="https://NeuroSYS-pl.github.io/magda/docs/next/modules/stateful/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://NeuroSYS-pl.github.io/magda/docs/next/modules/stateful/" hreflang="x-default"><link rel="stylesheet" href="/magda/assets/css/styles.369f8454.css">
<link rel="preload" href="/magda/assets/js/runtime~main.434a9ea3.js" as="script">
<link rel="preload" href="/magda/assets/js/main.be521564.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/magda/"><b class="navbar__title">MAGDA üëß</b></a><a class="navbar__item navbar__link navbar__link--active" href="/magda/docs/next/home/">Guides</a><a href="https://github.com/NeuroSYS-pl/magda/tree/main/examples" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Examples<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" href="/magda/docs/next/home/">Next</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link navbar__link--active" href="/magda/docs/next/modules/stateful/">Next</a></li><li><a class="dropdown__link" href="/magda/docs/modules/stateful/">0.1</a></li></ul></div><a href="https://github.com/NeuroSYS-pl/magda" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">üåû</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/magda/docs/next/home/">What is MAGDA?</a></li><li class="menu__list-item"><a class="menu__link" href="/magda/docs/next/quick-start/">Quick Start ‚è±Ô∏è</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Modules</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/magda/docs/next/modules/module/">General outlook</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/magda/docs/next/modules/workflow/">Workflow</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/magda/docs/next/modules/interfaces/">Interfaces</a></li><li class="menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/magda/docs/next/modules/stateful/">Stateful Modules</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Pipelines</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Configuration</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for MAGDA <b>Next</b> version.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/magda/docs/modules/stateful/">latest version</a></b> (0.1).</div></div><div class="docItemContainer_33ec"><article><span class="badge badge--secondary">Version: Next</span><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1>Stateless vs. stateful processing</h1></header><p>So far only regular stateless modules were described. Stateless because they don&#x27;t store any data between requests. Even though they have their advantages, sometimes there is a need to remember some information after every <code>pipeline.run</code> excecution.
For instance, collecting statistics. This can&#x27;t be achieved without storing results from previous runs. That&#x27;s why there is a need for stateful modules which in <em>MAGDA</em> are called the aggregation modules. </p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="pipeline-modes"></a>Pipeline modes<a class="hash-link" href="#pipeline-modes" title="Direct link to heading">#</a></h2><p>The pipeline can work in one of two modes: <strong>run</strong> or <strong>process</strong>. </p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="auxiliary-notions"></a>Auxiliary notions<a class="hash-link" href="#auxiliary-notions" title="Direct link to heading">#</a></h3><p>Before discussing any more complex pipelines, let&#x27;s define a few commonly used terms:</p><ul><li><p><strong>Regular module</strong><br>
A module that inherits from <code>Module.Runtime</code>. It is stateless.<br>
If it precedes an aggregation module it&#x27;s marked as a yellow box on any diagram and is executed only during <code>pipeline.run</code>.<br>
When it follows an aggregation module it&#x27;s marked as a purple box. Then it&#x27;s only executed during the <code>pipeline.process</code> and works on the collected data.</p></li><li><p><strong>Aggregation module</strong><br>
A module that inherits from <code>ModuleAggregate</code> and aggregates a preceding module&#x27;s outputs. It is stateful. It&#x27;s marked as a purple box on any diagram (additionally with <em>(Agg)</em>).</p></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="run-mode"></a>Run mode<a class="hash-link" href="#run-mode" title="Direct link to heading">#</a></h3><p>The run mode calls the <code>run</code> method in every regular module and passes an output of each module as an input to the next one.
Since regular modules are stateless there is no way to keep their results after each request. Hence the need for the aggregation modules. They are the ones that keep the state and aim to collect outputs of preceding modules.
The method that is responsible for adding data to an internal state in aggregation modules is <code>aggregate</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">aggregate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ResultSet</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">state</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>What&#x27;s important is that all regular modules that succeed aggregation modules (the purple ones) are not considered during the <code>run</code> mode at all. Aggregation modules do not pass their output further - it&#x27;s always the last module that is invoked on a particular pipeline branch in this mode (as shown in <a href="#exemplary-diagram">the diagram below</a>).</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="process-mode"></a>Process mode<a class="hash-link" href="#process-mode" title="Direct link to heading">#</a></h3><p>The <code>process</code> mode is used to process results aggregated during the <code>run</code> mode. All regular modules that precede the aggregation modules (the yellow ones) are omitted in this mode.<br>
The first modules to run are the aggregation modules which pass their full state (all of the previously aggregated results) to the following modules. To achieve that they invoke the <code>process</code> method.
It&#x27;s worth noting that once called, this method <strong>clears the aggregation module&#x27;s inner state</strong>. It means that invoking <code>pipeline.process</code> twice in a row doesn&#x27;t make much sense as during the second call aggregation modules won&#x27;t have any data to pass forward.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">process</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ResultSet</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    state_copy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">copy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">clear_state</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> state_copy</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Aggregation modules pass their state to the succeeding regular modules (the purple ones) which can then process or transform it, save to file, etc.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="exemplary-diagram"></a>Exemplary diagram<a class="hash-link" href="#exemplary-diagram" title="Direct link to heading">#</a></h2><p>Diagram presents a simplified example of a pipeline consisting of both regular and aggregation modules.</p><svg xmlns="http://www.w3.org/2000/svg" width="50%" height="802" viewBox="-0.5 -0.5 772 802" class="diagram"><defs><style>@import url(https://fonts.googleapis.com/css?family=Roboto);</style></defs><path fill="#f7f7f7" stroke="#ababab" stroke-width="2" pointer-events="all" d="M11 11h750v250H11zM11 541h750v250H11zM11 276h750v250H11z"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M102 99h80v80h-80z"></path><path d="M61 139h29.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M99.76 139l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#e1d5e7" stroke="#9673a6" stroke-width="2" pointer-events="all" d="M608 29h80v80h-80z"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M262 99h80v80h-80z"></path><path d="M528 68h68.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M605.76 68l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#e1d5e7" stroke="#9673a6" stroke-width="6" pointer-events="all" d="M448 29h80v80h-80z"></path><path d="M688 68h21.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M718.76 68l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M368 139h30q10 0 10-10V79q0-10 10-10h18.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M445.76 69l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M342 139h56q10 0 10 10v46q0 10 10 9.87l18.47-.23" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M445.47 204.53l-11.92 6.15 2.92-6.04-3.07-5.96z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M182 138.5h68.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M259.76 138.5l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M447.71 164.5h80v80h-80z"></path><circle cx="36" cy="139" fill="#dae8fc" stroke="#6c8ebf" stroke-width="2" pointer-events="all" r="15"></circle><circle cx="220" cy="114" fill="#ffc891" stroke="#bd8653" stroke-width="2" pointer-events="all" r="15"></circle><path d="M374.5 96.5L391 114l-16.5 17.5L358 114zM591 184.5h10l20 20-20 20h-10l-20-20zM488 51.5L504.5 69 488 86.5 471.5 69z" fill="#ffc891" stroke="#bd8653" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="none" pointer-events="all" d="M458 111h60v30h-60z"></path><text x="487.5" y="134.5" fill="#765A82" font-family="Roboto" font-weight="bold" text-anchor="middle" font-size="20">(Agg)</text><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M105.5 366h80v80h-80z"></path><path d="M64.5 406h29.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M103.26 406l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#e1d5e7" stroke="#9673a6" stroke-width="2" pointer-events="all" d="M611.5 296h80v80h-80z"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M265.5 366h80v80h-80z"></path><path d="M531.5 335h68.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M609.26 335l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#e1d5e7" stroke="#9673a6" stroke-width="6" pointer-events="all" d="M451.5 296h80v80h-80z"></path><path d="M691.5 335h21.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M722.26 335l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M371.5 406h30q10 0 10-10v-50q0-10 10-10h18.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M449.26 336l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M345.5 406h56q10 0 10 10v44q0 10 9.99 10.37l18.78.71" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M449.27 471.42l-12.22 5.54 3.22-5.88-2.77-6.11z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M185.5 405.5h68.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M263.26 405.5l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M451.5 431.5h80v80h-80z"></path><circle cx="39.5" cy="406" fill="#d5e8d4" stroke="#82b366" stroke-width="2" pointer-events="all" r="15"></circle><circle cx="223.5" cy="381" fill="#f8cecc" stroke="#b85450" stroke-width="2" pointer-events="all" r="15"></circle><path d="M378 363.5l16.5 17.5-16.5 17.5-16.5-17.5zM594.5 449h10l20 20-20 20h-10l-20-20z" fill="#f8cecc" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M500.5 306l16.5 17.5-16.5 17.5-16.5-17.5z" fill="#ffc891" stroke="#bd8653" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="none" pointer-events="all" d="M461.5 378h60v30h-60z"></path><text x="491" y="401.5" fill="#765A82" font-family="Roboto" font-weight="bold" text-anchor="middle" font-size="20">(Agg)</text><path d="M482.5 331l16.5 17.5-16.5 17.5-16.5-17.5z" fill="#f8cecc" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M95.5 629h80v80h-80z"></path><path d="M54.5 669h29.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M93.26 669l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#e1d5e7" stroke="#9673a6" stroke-width="2" pointer-events="all" d="M601.5 559h80v80h-80z"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M255.5 629h80v80h-80z"></path><path d="M521.5 598h68.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M599.26 598l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#e1d5e7" stroke="#9673a6" stroke-width="6" pointer-events="all" d="M441.5 559h80v80h-80z"></path><path d="M681.5 598h21.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M712.26 598l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M361.5 669h30q10 0 10-10v-50q0-10 10-10h18.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M439.26 599l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M335.5 669h56q10 0 10 10v44q0 10 10 10.25l18.77.47" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M439.26 733.94l-12.14 5.7 3.15-5.92-2.85-6.07z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M175.5 668.5h68.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M253.26 668.5l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M441.5 694h80v80h-80z"></path><path d="M565.5 556l16.5 17.5-16.5 17.5-16.5-17.5z" fill="#ffc891" stroke="#bd8653" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="none" pointer-events="all" d="M451.5 641h60v30h-60z"></path><text x="481" y="664.5" fill="#765A82" font-family="Roboto" font-weight="bold" text-anchor="middle" font-size="20">(Agg)</text><path d="M555.5 556l16.5 17.5-16.5 17.5-16.5-17.5z" fill="#f8cecc" stroke="#b85450" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M521.5 733.66h21.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M552.26 733.66l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M528 204.16h21.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M558.76 204.16l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M531.5 468.66h21.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M562.26 468.66l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M724.5 573.28c0-2.37 4.48-4.28 10-4.28 2.65 0 5.2.45 7.07 1.25 1.88.8 2.93 1.89 2.93 3.03v51.44c0 1.14-1.05 2.23-2.93 3.03-1.87.8-4.42 1.25-7.07 1.25-2.65 0-5.2-.45-7.07-1.25-1.88-.8-2.93-1.89-2.93-3.03z" fill="#d1d1d1" stroke="#666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M744.5 573.28c0 1.13-1.05 2.22-2.93 3.02-1.87.8-4.42 1.25-7.07 1.25-2.65 0-5.2-.45-7.07-1.25-1.88-.8-2.93-1.89-2.93-3.02" fill="none" stroke="#666" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="none" pointer-events="all" d="M22.79 481.5h150v30h-150z"></path><text x="24.29" y="505" fill="#999" font-family="Roboto" font-weight="bold" font-size="20">pipeline.run( )</text><path fill="none" pointer-events="all" d="M24.5 214.5h150v30h-150z"></path><text x="26" y="238" fill="#999" font-family="Roboto" font-weight="bold" font-size="20">pipeline.run( )</text><path fill="none" pointer-events="all" d="M24.5 744h170v30h-170z"></path><text x="26" y="767.5" fill="#999" font-family="Roboto" font-weight="bold" font-size="20">pipeline.process()</text><circle cx="147" cy="232" fill="#dae8fc" stroke="#6c8ebf" stroke-width="2" pointer-events="all" r="10"></circle><circle cx="145" cy="499" fill="#d5e8d4" stroke="#82b366" stroke-width="2" pointer-events="all" r="10"></circle><path d="M141.94 151.35c6.88 0 12.22-5.54 12.22-12.28 0-6.06-4.66-12.16-12.46-12.16-5.59 0-11.93 4.59-11.93 12.24 0 6.38 5.14 12.2 12.17 12.2zM138.66 164c-1.88-.33-3.73-.74-5.48-1.45l.1-4.11c-1.3-.51-2.59-1.23-3.89-2.29l-3.65 2.15c-1.28-1.31-2.56-2.6-3.85-4.2l2.37-3.52c-.76-.98-1.62-2.48-2.1-4.09l-4.14-.03c-.43-1.66-.8-3.48-1.02-5.69l3.84-1.5c-.08-1.39.13-3.34.4-4.72l-3.32-2.29c.56-1.77 1.21-3.52 2.15-5.21l4.06.77c.68-1.3 1.71-2.52 2.9-3.7l-1.62-3.7c1.33-1.27 2.93-2.37 4.65-3.38l3.04 2.81c1.47-.72 3.16-1.2 4.39-1.34l.67-4.16c1.94-.33 3.98-.35 5.73-.16l.95 3.88c1.5.25 3.01.59 4.55 1.17l2.76-2.99c1.72.76 3.38 1.78 4.85 2.88l-1.22 3.81c1.22 1.21 2.41 2.38 3.08 3.5l4.02-1.02c1.07 1.63 1.9 3.31 2.54 5.02l-3.15 2.55c.45 1.56.7 3.31.79 4.68l3.94 1.22c-.08 1.9-.23 4.25-.61 5.62l-4.13.5c-.4 1.6-1 3-1.7 4.29l2.58 3.23c-.79 1.29-2.12 3-3.53 4.39l-3.69-1.87c-.93.91-2.26 1.89-3.77 2.57l.39 4.2c-1.59.77-3.37 1.38-5.3 1.85l-2.1-3.62c-1.27.25-3.27.39-4.67.18zM301.94 151.35c6.88 0 12.22-5.54 12.22-12.28 0-6.06-4.66-12.16-12.46-12.16-5.59 0-11.93 4.59-11.93 12.24 0 6.38 5.14 12.2 12.17 12.2zM298.66 164c-1.88-.33-3.73-.74-5.48-1.45l.1-4.11c-1.3-.51-2.59-1.23-3.89-2.29l-3.65 2.15c-1.28-1.31-2.56-2.6-3.85-4.2l2.37-3.52c-.76-.98-1.62-2.48-2.1-4.09l-4.14-.03c-.43-1.66-.8-3.48-1.02-5.69l3.84-1.5c-.08-1.39.13-3.34.4-4.72l-3.32-2.29c.56-1.77 1.21-3.52 2.15-5.21l4.06.77c.68-1.3 1.71-2.52 2.9-3.7l-1.62-3.7c1.33-1.27 2.93-2.37 4.65-3.38l3.04 2.81c1.47-.72 3.16-1.2 4.39-1.34l.67-4.16c1.94-.33 3.98-.35 5.73-.16l.95 3.88c1.5.25 3.01.59 4.55 1.17l2.76-2.99c1.72.76 3.38 1.78 4.85 2.88l-1.22 3.81c1.22 1.21 2.41 2.38 3.08 3.5l4.02-1.02c1.07 1.63 1.9 3.31 2.54 5.02l-3.15 2.55c.45 1.56.7 3.31.79 4.68l3.94 1.22c-.08 1.9-.23 4.25-.61 5.62l-4.13.5c-.4 1.6-1 3-1.7 4.29l2.58 3.23c-.79 1.29-2.12 3-3.53 4.39l-3.69-1.87c-.93.91-2.26 1.89-3.77 2.57l.39 4.2c-1.59.77-3.37 1.38-5.3 1.85l-2.1-3.62c-1.27.25-3.27.39-4.67.18zM487.94 216.35c6.88 0 12.22-5.54 12.22-12.28 0-6.06-4.66-12.16-12.46-12.16-5.59 0-11.93 4.59-11.93 12.24 0 6.38 5.14 12.2 12.17 12.2zM484.66 229c-1.88-.33-3.73-.74-5.48-1.45l.1-4.11c-1.3-.51-2.59-1.23-3.89-2.29l-3.65 2.15c-1.28-1.31-2.56-2.6-3.85-4.2l2.37-3.52c-.76-.98-1.62-2.48-2.1-4.09l-4.14-.03c-.43-1.66-.8-3.48-1.02-5.69l3.84-1.5c-.08-1.39.13-3.34.4-4.72l-3.32-2.29c.56-1.77 1.21-3.52 2.15-5.21l4.06.77c.68-1.3 1.71-2.52 2.9-3.7l-1.62-3.7c1.33-1.27 2.93-2.37 4.65-3.38l3.04 2.81c1.47-.72 3.16-1.2 4.39-1.34l.67-4.16c1.94-.33 3.98-.35 5.73-.16l.95 3.88c1.5.25 3.01.59 4.55 1.17l2.76-2.99c1.72.76 3.38 1.78 4.85 2.88l-1.22 3.81c1.22 1.21 2.41 2.38 3.08 3.5l4.02-1.02c1.07 1.63 1.9 3.31 2.54 5.02l-3.15 2.55c.45 1.56.7 3.31.79 4.68l3.94 1.22c-.08 1.9-.23 4.25-.61 5.62l-4.13.5c-.4 1.6-1 3-1.7 4.29l2.58 3.23c-.79 1.29-2.12 3-3.53 4.39l-3.69-1.87c-.93.91-2.26 1.89-3.77 2.57l.39 4.2c-1.59.77-3.37 1.38-5.3 1.85l-2.1-3.62c-1.27.25-3.27.39-4.67.18zM146.94 418.35c6.88 0 12.22-5.54 12.22-12.28 0-6.06-4.66-12.16-12.46-12.16-5.59 0-11.93 4.59-11.93 12.24 0 6.38 5.14 12.2 12.17 12.2zM143.66 431c-1.88-.33-3.73-.74-5.48-1.45l.1-4.11c-1.3-.51-2.59-1.23-3.89-2.29l-3.65 2.15c-1.28-1.31-2.56-2.6-3.85-4.2l2.37-3.52c-.76-.98-1.62-2.48-2.1-4.09l-4.14-.03c-.43-1.66-.8-3.48-1.02-5.69l3.84-1.5c-.08-1.39.13-3.34.4-4.72l-3.32-2.29c.56-1.77 1.21-3.52 2.15-5.21l4.06.77c.68-1.3 1.71-2.52 2.9-3.7l-1.62-3.7c1.33-1.27 2.93-2.37 4.65-3.38l3.04 2.81c1.47-.72 3.16-1.2 4.39-1.34l.67-4.16c1.94-.33 3.98-.35 5.73-.16l.95 3.88c1.5.25 3.01.59 4.55 1.17l2.76-2.99c1.72.76 3.38 1.78 4.85 2.88l-1.22 3.81c1.22 1.21 2.41 2.38 3.08 3.5l4.02-1.02c1.07 1.63 1.9 3.31 2.54 5.02l-3.15 2.55c.45 1.56.7 3.31.79 4.68l3.94 1.22c-.08 1.9-.23 4.25-.61 5.62l-4.13.5c-.4 1.6-1 3-1.7 4.29l2.58 3.23c-.79 1.29-2.12 3-3.53 4.39l-3.69-1.87c-.93.91-2.26 1.89-3.77 2.57l.39 4.2c-1.59.77-3.37 1.38-5.3 1.85l-2.1-3.62c-1.27.25-3.27.39-4.67.18zM305.44 418.35c6.88 0 12.22-5.54 12.22-12.28 0-6.06-4.66-12.16-12.46-12.16-5.59 0-11.93 4.59-11.93 12.24 0 6.38 5.14 12.2 12.17 12.2zM302.16 431c-1.88-.33-3.73-.74-5.48-1.45l.1-4.11c-1.3-.51-2.59-1.23-3.89-2.29l-3.65 2.15c-1.28-1.31-2.56-2.6-3.85-4.2l2.37-3.52c-.76-.98-1.62-2.48-2.1-4.09l-4.14-.03c-.43-1.66-.8-3.48-1.02-5.69l3.84-1.5c-.08-1.39.13-3.34.4-4.72l-3.32-2.29c.56-1.77 1.21-3.52 2.15-5.21l4.06.77c.68-1.3 1.71-2.52 2.9-3.7l-1.62-3.7c1.33-1.27 2.93-2.37 4.65-3.38l3.04 2.81c1.47-.72 3.16-1.2 4.39-1.34l.67-4.16c1.94-.33 3.98-.35 5.73-.16l.95 3.88c1.5.25 3.01.59 4.55 1.17l2.76-2.99c1.72.76 3.38 1.78 4.85 2.88l-1.22 3.81c1.22 1.21 2.41 2.38 3.08 3.5l4.02-1.02c1.07 1.63 1.9 3.31 2.54 5.02l-3.15 2.55c.45 1.56.7 3.31.79 4.68l3.94 1.22c-.08 1.9-.23 4.25-.61 5.62l-4.13.5c-.4 1.6-1 3-1.7 4.29l2.58 3.23c-.79 1.29-2.12 3-3.53 4.39l-3.69-1.87c-.93.91-2.26 1.89-3.77 2.57l.39 4.2c-1.59.77-3.37 1.38-5.3 1.85l-2.1-3.62c-1.27.25-3.27.39-4.67.18zM492.94 483.85c6.88 0 12.22-5.54 12.22-12.28 0-6.06-4.66-12.16-12.46-12.16-5.59 0-11.93 4.59-11.93 12.24 0 6.38 5.14 12.2 12.17 12.2zm-3.28 12.65c-1.88-.33-3.73-.74-5.48-1.45l.1-4.11c-1.3-.51-2.59-1.23-3.89-2.29l-3.65 2.15c-1.28-1.31-2.56-2.6-3.85-4.2l2.37-3.52c-.76-.98-1.62-2.48-2.1-4.09l-4.14-.03c-.43-1.66-.8-3.48-1.02-5.69l3.84-1.5c-.08-1.39.13-3.34.4-4.72l-3.32-2.29c.56-1.77 1.21-3.52 2.15-5.21l4.06.77c.68-1.3 1.71-2.52 2.9-3.7l-1.62-3.7c1.33-1.27 2.93-2.37 4.65-3.38l3.04 2.81c1.47-.72 3.16-1.2 4.39-1.34l.67-4.16c1.94-.33 3.98-.35 5.73-.16l.95 3.88c1.5.25 3.01.59 4.55 1.17l2.76-2.99c1.72.76 3.38 1.78 4.85 2.88l-1.22 3.81c1.22 1.21 2.41 2.38 3.08 3.5l4.02-1.02c1.07 1.63 1.9 3.31 2.54 5.02l-3.15 2.55c.45 1.56.7 3.31.79 4.68l3.94 1.22c-.08 1.9-.23 4.25-.61 5.62l-4.13.5c-.4 1.6-1 3-1.7 4.29l2.58 3.23c-.79 1.29-2.12 3-3.53 4.39l-3.69-1.87c-.93.91-2.26 1.89-3.77 2.57l.39 4.2c-1.59.77-3.37 1.38-5.3 1.85l-2.1-3.62c-1.27.25-3.27.39-4.67.18zM641.44 611.35c6.88 0 12.22-5.54 12.22-12.28 0-6.06-4.66-12.16-12.46-12.16-5.59 0-11.93 4.59-11.93 12.24 0 6.38 5.14 12.2 12.17 12.2zM638.16 624c-1.88-.33-3.73-.74-5.48-1.45l.1-4.11c-1.3-.51-2.59-1.23-3.89-2.29l-3.65 2.15c-1.28-1.31-2.56-2.6-3.85-4.2l2.37-3.52c-.76-.98-1.62-2.48-2.1-4.09l-4.14-.03c-.43-1.66-.8-3.48-1.02-5.69l3.84-1.5c-.08-1.39.13-3.34.4-4.72l-3.32-2.29c.56-1.77 1.21-3.52 2.15-5.21l4.06.77c.68-1.3 1.71-2.52 2.9-3.7l-1.62-3.7c1.33-1.27 2.93-2.37 4.65-3.38l3.04 2.81c1.47-.72 3.16-1.2 4.39-1.34l.67-4.16c1.94-.33 3.98-.35 5.73-.16l.95 3.88c1.5.25 3.01.59 4.55 1.17l2.76-2.99c1.72.76 3.38 1.78 4.85 2.88l-1.22 3.81c1.22 1.21 2.41 2.38 3.08 3.5l4.02-1.02c1.07 1.63 1.9 3.31 2.54 5.02l-3.15 2.55c.45 1.56.7 3.31.79 4.68l3.94 1.22c-.08 1.9-.23 4.25-.61 5.62l-4.13.5c-.4 1.6-1 3-1.7 4.29l2.58 3.23c-.79 1.29-2.12 3-3.53 4.39l-3.69-1.87c-.93.91-2.26 1.89-3.77 2.57l.39 4.2c-1.59.77-3.37 1.38-5.3 1.85l-2.1-3.62c-1.27.25-3.27.39-4.67.18zM488.83 574l18.67 15.59-18.67 15.58v-8.08c-17.3 0-31.33 12.05-31.33 26.91 0-23.15 14.03-41.91 31.33-41.91z" fill="none" stroke="#333" stroke-width="4" stroke-miterlimit="10" pointer-events="all"></path><path d="M623 44h14.58L648 58.8 658.42 44H673l-17.71 25L673 94h-14.58L648 79.2 637.58 94H623l16.67-25zM626.5 311h14.58l10.42 14.8 10.42-14.8h14.58l-17.71 25 17.71 25h-14.58l-10.42-14.8-10.42 14.8H626.5l16.67-25zM270.5 645h14.58l10.42 14.8 10.42-14.8h14.58l-17.71 25 17.71 25h-14.58l-10.42-14.8-10.42 14.8H270.5l16.67-25zM110.5 645h14.58l10.42 14.8 10.42-14.8h14.58l-17.71 25 17.71 25h-14.58l-10.42-14.8-10.42 14.8H110.5l16.67-25zM456.5 709h14.58l10.42 14.8 10.42-14.8h14.58l-17.71 25 17.71 25h-14.58l-10.42-14.8-10.42 14.8H456.5l16.67-25z" fill="none" stroke="#333" stroke-opacity="0.5" stroke-width="4" stroke-miterlimit="10" pointer-events="all"></path></svg><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="moduleaggregate-usage"></a><code>ModuleAggregate</code> usage<a class="hash-link" href="#moduleaggregate-usage" title="Direct link to heading">#</a></h2><p>The capabilities of aggregation modules are presented below with simple examples, which show multiple ways in which they can be used. But first, let&#x27;s declare some common code.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="common-code"></a>Common code<a class="hash-link" href="#common-code" title="Direct link to heading">#</a></h3><p>First, it&#x27;s necessary to declare module classes. Supposing that, the pipeline consists of only two modules: one regular module and one aggregation module.
The regular module returns the value of its parameter <code>val</code> multiplied by the request - the value passed during <code>pipeline.run(request)</code> invocation.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> magda</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">module </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Module</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> magda</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">decorators </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> finalize</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> accept</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> expose </span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@expose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@finalize</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">RegularModule</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Runtime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> request</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">parameters</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;val&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> request</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@expose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@accept</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">RegularModule</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@finalize</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">AggregationModule</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Aggregate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pass</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The next step is to build a pipeline. For simplicity, a sequential pipeline which consists of only two modules is declared - a regular module that passes its output forward and an aggregate module that collects data.</p><p>The pipeline can be declared in <strong>one of two ways</strong> - from code (in <code>Code-first</code> mode) or using a configuration file (<code>Config-first</code>).</p><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1uMI tabs__item--active">Code-first</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_1uMI">Config-first</li></ul><div class="margin-vert--md"><div role="tabpanel"><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> magda</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pipeline </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> SequentialPipeline</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">reg_mod </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> RegularModule</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;reg_mod&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_parameters</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;val&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">agg_mod </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> AggregationModule</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;agg_mod&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">depends_on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">reg_mod</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">builder </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SequentialPipeline</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_module</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">reg_mod</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_module</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">agg_mod</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">pipeline </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> builder</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">build</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><div role="tabpanel" hidden=""><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">modules</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> reg_mod</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> regular</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">module</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">parameters</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">val</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> agg_mod</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> aggregation</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">module</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">depends_on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> reg_mod</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>However, in order to use the config in code we would have to register previously declared modules in the <code>ModuleFactory</code> and then read the config like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> magda</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">config_reader </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> ConfigReader</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> magda</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">module </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> ModuleFactory</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ModuleFactory</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">register</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;regular-module&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> RegularModule</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">ModuleFactory</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">register</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;aggregation-module&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> AggregationModule</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">pipeline </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ConfigReader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config_file_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ModuleFactory</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div></div></div><p>The <code>reg_mod</code> has an additional parameter called <code>val</code>. It outputs its value multiplied by the request value which is passed as an input to the aggregation module.</p><p>The last step is running the pipeline. Running it twice in the run mode and once in the process mode should give a clear picture of what happens. </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">run1_output </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">run2_output </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">process_output </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">process</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Process: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">process_output</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Now everything&#x27;s set - how to declare modules and how to build and execute a pipeline.
In the examples below the only code fragment that changes is the declaration of the <code>AggregationModule</code> - we want to show how its modification results in different outputs.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="small-simplification"></a>Small simplification<a class="hash-link" href="#small-simplification" title="Direct link to heading">#</a></h3><p>Before we run the first example let&#x27;s look at the output of our aggregation module:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Process</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;agg_mod&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">magda</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">results</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ResultSet </span><span class="token builtin">object</span><span class="token plain"> at </span><span class="token number" style="color:#36acaa">0x7f2d3826dc70</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">magda</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">results</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ResultSet </span><span class="token builtin">object</span><span class="token plain"> at </span><span class="token number" style="color:#36acaa">0x7f2d3826dac0</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>It&#x27;s not exactly what we expected. This form of output gives us no meaningful information. We can see that the aggregation module collected indeed two <code>ResultSet</code> but we&#x27;re not able to verify their content or value. That&#x27;s why (for clarity only) we&#x27;re going to change just the output of our aggregation module:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">AggregationModule</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Aggregate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">aggregate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ResultSet</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">RegularModule</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># instead of self.add_data(data)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">state</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Instead of <code>data</code> we now add <code>data.get(RegularModule)</code> to the inner state - any output from the <code>RegularModule</code> that came as an input to the <code>AggregationModule</code>. Now the output looks much more clearly: </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Process</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;agg_mod&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">110</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">220</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>On this account, we&#x27;ll stick to this small &quot;simplification&quot; in all the following examples.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="example-1---the-original-implementation"></a>Example 1 - the original implementation<a class="hash-link" href="#example-1---the-original-implementation" title="Direct link to heading">#</a></h2><p>The aggregation module collects its inputs in its inner state during run modes and passes the state further during process mode (clearing it). If we run the above code we&#x27;ll get the output we just saw:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Process</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;agg_mod&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">110</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">220</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="running-the-pipeline-differently"></a>Running the pipeline differently<a class="hash-link" href="#running-the-pipeline-differently" title="Direct link to heading">#</a></h3><p>Using this simple example we are dealing with right now, we can additionally show how the pipeline (and the modules) behaves when we call <code>pipeline.run</code> and <code>pipeline.process</code> multiple times. Let&#x27;s assume just for a moment that we invoke this code fragment:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">run1_output </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">run2_output </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">process1_output </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">process</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">run3_output </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">40</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">process2_output </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pipeline</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">process</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Run(10): </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">run1_output</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Run(20): </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">run2_output</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Process: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">process1_output</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Run(40): </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">run3_output</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Process: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">process2_output</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>We get the following output:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;reg_mod&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">110</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">Run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;reg_mod&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">220</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">Process</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;agg_mod&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">110</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">220</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">Run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">40</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;reg_mod&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">440</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">Process</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;agg_mod&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">440</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>As mentioned before, the aggregation module clears its state after every process mode. We can see that the second <code>pipeline.process</code> outputs a list with only one element (not three) - the output of the regular module which was obtained during the last <code>pipeline.run(40)</code>. This behavior is also visibly shown in the diagram below.</p><svg xmlns="http://www.w3.org/2000/svg" width="50%" height="711" viewBox="-0.5 -0.5 532 711" class="diagram"><defs><style>@import url(https://fonts.googleapis.com/css?family=Roboto);</style></defs><path fill="#f7f7f7" stroke="#ababab" stroke-width="2" pointer-events="all" d="M11 11h510v133H11zM11 150h510v133H11zM11 289h510v133H11zM11 428h510v133H11zM11 567h510v133H11z"></path><path d="M396 620h38.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M443.76 620l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M396 202h38.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M443.76 202l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M396 342h38.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M443.76 342l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M396 480h38.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M443.76 480l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M396 63h38.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M443.76 63l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M126 23h80v80h-80z"></path><path fill="#e1d5e7" stroke="#9673a6" stroke-width="6" pointer-events="all" d="M316 23h80v80h-80z"></path><path fill="none" pointer-events="all" d="M326 103h60v30h-60z"></path><text x="355.5" y="126.5" fill="#765A82" font-family="Roboto" font-weight="bold" text-anchor="middle" font-size="20">(Agg)</text><path d="M76 63h38.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M123.76 63l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="none" pointer-events="all" d="M20 395h140v20H20z"></path><text x="21.5" y="411.5" fill="#999" font-family="Roboto" font-weight="bold" font-size="16">pipeline.process()</text><circle cx="47" cy="63" fill="#f8cecc" stroke="#b85450" stroke-width="2" pointer-events="all" r="21"></circle><text x="46.5" y="69.5" font-family="Roboto" text-anchor="middle" font-size="16">10</text><circle cx="356" cy="62" fill="#f8cecc" stroke="#b85450" stroke-width="2" pointer-events="all" r="21"></circle><text x="355.5" y="68.5" font-family="Roboto" text-anchor="middle" font-size="16">110</text><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M126 162h80v80h-80z"></path><path fill="#e1d5e7" stroke="#9673a6" stroke-width="6" pointer-events="all" d="M316 162h80v80h-80z"></path><path fill="none" pointer-events="all" d="M326 242h60v30h-60z"></path><text x="355.5" y="265.5" fill="#765A82" font-family="Roboto" font-weight="bold" text-anchor="middle" font-size="20">(Agg)</text><path d="M76 202h38.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M123.76 202l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><circle cx="47" cy="202" fill="#ffe6cc" stroke="#d79b00" stroke-width="2" pointer-events="all" r="21"></circle><text x="46.5" y="208.5" font-family="Roboto" text-anchor="middle" font-size="16">20</text><ellipse cx="166" cy="202" rx="32.5" ry="20" fill="#ffe6cc" stroke="#d79b00" stroke-width="2" pointer-events="all"></ellipse><text x="165.5" y="208.5" font-family="Roboto" text-anchor="middle" font-size="16">20 * 11</text><circle cx="364" cy="195" fill="#f8cecc" stroke="#b85450" stroke-width="2" pointer-events="all" r="21"></circle><text x="363.5" y="201.5" font-family="Roboto" text-anchor="middle" font-size="16">110</text><circle cx="350" cy="210" fill="#ffe6cc" stroke="#d79b00" stroke-width="2" pointer-events="all" r="21"></circle><text x="349.5" y="216.5" font-family="Roboto" text-anchor="middle" font-size="16">220</text><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M126 302h80v80h-80z"></path><path fill="#e1d5e7" stroke="#9673a6" stroke-width="6" pointer-events="all" d="M316 302h80v80h-80z"></path><path fill="none" pointer-events="all" d="M326 382h60v30h-60z"></path><text x="355.5" y="405.5" fill="#765A82" font-family="Roboto" font-weight="bold" text-anchor="middle" font-size="20">(Agg)</text><path d="M76 342h38.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M123.76 342l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><circle cx="487" cy="342" fill="#f8cecc" stroke="#b85450" stroke-width="2" pointer-events="all" r="21"></circle><text x="486.5" y="348.5" font-family="Roboto" text-anchor="middle" font-size="16">110</text><circle cx="473" cy="342" fill="#ffe6cc" stroke="#d79b00" stroke-width="2" pointer-events="all" r="21"></circle><text x="472.5" y="348.5" font-family="Roboto" text-anchor="middle" font-size="16">220</text><path fill="none" pointer-events="all" d="M20 255h130v20H20z"></path><text x="21.5" y="271.5" fill="#999" font-family="Roboto" font-weight="bold" font-size="16">pipeline.run(20)</text><path fill="none" pointer-events="all" d="M20 116h130v20H20z"></path><text x="21.5" y="132.5" fill="#999" font-family="Roboto" font-weight="bold" font-size="16">pipeline.run(10)</text><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M126 440h80v80h-80z"></path><path fill="#e1d5e7" stroke="#9673a6" stroke-width="6" pointer-events="all" d="M316 440h80v80h-80z"></path><path fill="none" pointer-events="all" d="M326 520h60v30h-60z"></path><text x="355.5" y="543.5" fill="#765A82" font-family="Roboto" font-weight="bold" text-anchor="middle" font-size="20">(Agg)</text><path d="M76 480h38.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M123.76 480l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><circle cx="47" cy="480" fill="#dae8fc" stroke="#6c8ebf" stroke-width="2" pointer-events="all" r="21"></circle><text x="46.5" y="486.5" font-family="Roboto" text-anchor="middle" font-size="16">40</text><ellipse cx="166" cy="480" rx="32.5" ry="20" fill="#dae8fc" stroke="#6c8ebf" stroke-width="2" pointer-events="all"></ellipse><text x="165.5" y="486.5" font-family="Roboto" text-anchor="middle" font-size="16">40 * 11</text><circle cx="356" cy="480" fill="#dae8fc" stroke="#6c8ebf" stroke-width="2" pointer-events="all" r="21"></circle><text x="355.5" y="486.5" font-family="Roboto" text-anchor="middle" font-size="16">440</text><path fill="none" pointer-events="all" d="M20 533h130v20H20z"></path><text x="21.5" y="549.5" fill="#999" font-family="Roboto" font-weight="bold" font-size="16">pipeline.run(40)</text><path fill="none" pointer-events="all" d="M20 673h140v20H20z"></path><text x="21.5" y="689.5" fill="#999" font-family="Roboto" font-weight="bold" font-size="16">pipeline.process()</text><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M126 580h80v80h-80z"></path><path fill="#e1d5e7" stroke="#9673a6" stroke-width="6" pointer-events="all" d="M316 580h80v80h-80z"></path><path fill="none" pointer-events="all" d="M326 660h60v30h-60z"></path><text x="355.5" y="683.5" fill="#765A82" font-family="Roboto" font-weight="bold" text-anchor="middle" font-size="20">(Agg)</text><path d="M76 620h38.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M123.76 620l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><circle cx="473" cy="620" fill="#dae8fc" stroke="#6c8ebf" stroke-width="2" pointer-events="all" r="21"></circle><text x="472.5" y="626.5" font-family="Roboto" text-anchor="middle" font-size="16">440</text><path d="M206 620h98.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M313.76 620l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M206 480h98.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M313.76 480l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><circle cx="257" cy="480" fill="#dae8fc" stroke="#6c8ebf" stroke-width="2" pointer-events="all" r="21"></circle><text x="256.5" y="486.5" font-family="Roboto" text-anchor="middle" font-size="16">440</text><path d="M206 342h98.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M313.76 342l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M206 202h98.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M313.76 202l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M206 63h98.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M313.76 63l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><circle cx="257" cy="63" fill="#f8cecc" stroke="#b85450" stroke-width="2" pointer-events="all" r="21"></circle><text x="256.5" y="69.5" font-family="Roboto" text-anchor="middle" font-size="16">110</text><circle cx="257" cy="202" fill="#ffe6cc" stroke="#d79b00" stroke-width="2" pointer-events="all" r="21"></circle><text x="256.5" y="208.5" font-family="Roboto" text-anchor="middle" font-size="16">220</text><ellipse cx="166" cy="63" rx="32.5" ry="20" fill="#f8cecc" stroke="#b85450" stroke-width="2" pointer-events="all"></ellipse><text x="165.5" y="69.5" font-family="Roboto" text-anchor="middle" font-size="16">10 * 11</text><path d="M362.33 595L381 610.59l-18.67 15.58v-8.08c-17.3 0-31.33 12.05-31.33 26.91 0-23.15 14.03-41.91 31.33-41.91zM362.33 317L381 332.58l-18.67 15.59v-8.09c-17.3 0-31.33 12.06-31.33 26.92 0-23.15 14.03-41.91 31.33-41.91z" fill="none" stroke="#333" stroke-width="4" stroke-miterlimit="10" pointer-events="all"></path><path d="M141 595h14.58L166 609.8l10.42-14.8H191l-17.71 25L191 645h-14.58L166 630.2 155.58 645H141l16.67-25zM141 317h14.58L166 331.8l10.42-14.8H191l-17.71 25L191 367h-14.58L166 352.2 155.58 367H141l16.67-25z" fill="none" stroke="#333" stroke-opacity="0.5" stroke-width="4" stroke-miterlimit="10" pointer-events="all"></path></svg><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="example-2---overriding-the-process-method"></a>Example 2 - overriding the <code>process</code> method<a class="hash-link" href="#example-2---overriding-the-process-method" title="Direct link to heading">#</a></h2><p>The aggregation module can not only serve to collect data and pass it further. It&#x27;s only its basic implementation. It can also process its inputs. To achieve that we can override the <code>process</code> method:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">AggregationModule</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Aggregate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">process</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ResultSet</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        state_copy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_current_state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">copy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">clear_state</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token builtin">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">state_copy</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The only change that was applied here is the return statement. We output not the list of objects but its sum. As simple as that:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Process</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;agg_mod&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">330</span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>We can also visualize this behavior using a diagram.</p><svg xmlns="http://www.w3.org/2000/svg" width="50%" height="433" viewBox="-0.5 -0.5 532 433" class="diagram"><defs><style>@import url(https://fonts.googleapis.com/css?family=Roboto);</style></defs><path fill="#f7f7f7" stroke="#ababab" stroke-width="2" pointer-events="all" d="M11 11h510v133H11zM11 150h510v133H11zM11 289h510v133H11z"></path><path d="M396 202h38.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M443.76 202l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M396 342h38.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M443.76 342l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M396 63h38.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M443.76 63l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M126 23h80v80h-80z"></path><path fill="#e1d5e7" stroke="#9673a6" stroke-width="6" pointer-events="all" d="M316 23h80v80h-80z"></path><path fill="none" pointer-events="all" d="M326 103h60v30h-60z"></path><text x="355.5" y="126.5" fill="#765A82" font-family="Roboto" font-weight="bold" text-anchor="middle" font-size="20">(Agg)</text><path d="M76 63h38.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M123.76 63l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="none" pointer-events="all" d="M20 395h140v20H20z"></path><text x="21.5" y="411.5" fill="#999" font-family="Roboto" font-weight="bold" font-size="16">pipeline.process()</text><circle cx="47" cy="63" fill="#f8cecc" stroke="#b85450" stroke-width="2" pointer-events="all" r="21"></circle><text x="46.5" y="69.5" font-family="Roboto" text-anchor="middle" font-size="16">10</text><ellipse cx="166" cy="63" rx="32.5" ry="20" fill="#f8cecc" stroke="#b85450" stroke-width="2" pointer-events="all"></ellipse><text x="165.5" y="69.5" font-family="Roboto" text-anchor="middle" font-size="16">10 * 11</text><circle cx="356" cy="62" fill="#f8cecc" stroke="#b85450" stroke-width="2" pointer-events="all" r="21"></circle><text x="355.5" y="68.5" font-family="Roboto" text-anchor="middle" font-size="16">110</text><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M126 162h80v80h-80z"></path><path fill="#e1d5e7" stroke="#9673a6" stroke-width="6" pointer-events="all" d="M316 162h80v80h-80z"></path><path fill="none" pointer-events="all" d="M326 242h60v30h-60z"></path><text x="355.5" y="265.5" fill="#765A82" font-family="Roboto" font-weight="bold" text-anchor="middle" font-size="20">(Agg)</text><path d="M76 202h38.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M123.76 202l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><circle cx="47" cy="202" fill="#ffe6cc" stroke="#d79b00" stroke-width="2" pointer-events="all" r="21"></circle><text x="46.5" y="208.5" font-family="Roboto" text-anchor="middle" font-size="16">20</text><ellipse cx="166" cy="202" rx="32.5" ry="20" fill="#ffe6cc" stroke="#d79b00" stroke-width="2" pointer-events="all"></ellipse><text x="165.5" y="208.5" font-family="Roboto" text-anchor="middle" font-size="16">20 * 11</text><circle cx="364" cy="195" fill="#f8cecc" stroke="#b85450" stroke-width="2" pointer-events="all" r="21"></circle><text x="363.5" y="201.5" font-family="Roboto" text-anchor="middle" font-size="16">110</text><circle cx="350" cy="210" fill="#ffe6cc" stroke="#d79b00" stroke-width="2" pointer-events="all" r="21"></circle><text x="349.5" y="216.5" font-family="Roboto" text-anchor="middle" font-size="16">220</text><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M126 302h80v80h-80z"></path><path fill="#e1d5e7" stroke="#9673a6" stroke-width="6" pointer-events="all" d="M316 302h80v80h-80z"></path><path fill="none" pointer-events="all" d="M326 382h60v30h-60z"></path><text x="355.5" y="405.5" fill="#765A82" font-family="Roboto" font-weight="bold" text-anchor="middle" font-size="20">(Agg)</text><path d="M76 342h38.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M123.76 342l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="none" pointer-events="all" d="M20 255h130v20H20z"></path><text x="21.5" y="271.5" fill="#999" font-family="Roboto" font-weight="bold" font-size="16">pipeline.run(20)</text><path fill="none" pointer-events="all" d="M20 116h130v20H20z"></path><text x="21.5" y="132.5" fill="#999" font-family="Roboto" font-weight="bold" font-size="16">pipeline.run(10)</text><path d="M206 342h98.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M313.76 342l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M206 202h98.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M313.76 202l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M206 63h98.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M313.76 63l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><circle cx="257" cy="63" fill="#f8cecc" stroke="#b85450" stroke-width="2" pointer-events="all" r="21"></circle><text x="256.5" y="69.5" font-family="Roboto" text-anchor="middle" font-size="16">110</text><circle cx="257" cy="202" fill="#ffe6cc" stroke="#d79b00" stroke-width="2" pointer-events="all" r="21"></circle><text x="256.5" y="208.5" font-family="Roboto" text-anchor="middle" font-size="16">220</text><circle cx="473" cy="342" fill="#e1d5e7" stroke="#9673a6" stroke-width="2" pointer-events="all" r="21"></circle><text x="472.5" y="348.5" font-family="Roboto" text-anchor="middle" font-size="16">330</text><circle cx="364" cy="334.5" fill-opacity="0.5" fill="#f8cecc" stroke="#b85450" stroke-opacity="0.5" stroke-width="2" pointer-events="all" r="21"></circle><text x="363.5" y="341" font-family="Roboto" text-anchor="middle" font-size="16" opacity="0.5">110</text><circle cx="350" cy="349.5" fill-opacity="0.5" fill="#ffe6cc" stroke="#d79b00" stroke-opacity="0.5" stroke-width="2" pointer-events="all" r="21"></circle><text x="349.5" y="356" font-family="Roboto" text-anchor="middle" font-size="16" opacity="0.5">220</text><path d="M337.25 334.79h13.54v-13.54h13.42v13.54h13.54v13.42h-13.54v13.54h-13.42v-13.54h-13.54z" fill="none" stroke="#2c262e" stroke-width="4" stroke-miterlimit="10" pointer-events="all"></path><path d="M141 317h14.58L166 331.8l10.42-14.8H191l-17.71 25L191 367h-14.58L166 352.2 155.58 367H141l16.67-25z" fill="none" stroke="#333" stroke-opacity="0.5" stroke-width="4" stroke-miterlimit="10" pointer-events="all"></path></svg><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="example-3---overriding-both-aggregate-and-process-methods"></a>Example 3 - overriding both <code>aggregate</code> and <code>process</code> methods<a class="hash-link" href="#example-3---overriding-both-aggregate-and-process-methods" title="Direct link to heading">#</a></h2><p>What if we would like to take full advantage of the aggregation module? We may not need to store all data within the module&#x27;s inner state meaning that our <code>aggregate</code> method could behave like a reduce operation:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">AggregationModule</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Aggregate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_current_state </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># instead of []</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">aggregate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ResultSet</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_current_state </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">RegularModule</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_current_state</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><details class="details_2Ziz alert alert--info details_1VDD" data-collapsed="true"><summary>The code fragment above could be replaced with the one which doesn&#x27;t need to override the aggregate method.</summary><div><div class="collapsibleContent_3OHp"><p>  We could override the <code>add_data</code> method leaving the original implementation of the <code>aggregate</code> method.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">AggregationModule</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Aggregate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_current_state </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># instead of []</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">aggregate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ResultSet</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># &quot;original&quot; implementation</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">RegularModule</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">state</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">add_data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_current_state </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> value  </span><span class="token comment" style="color:#999988;font-style:italic"># instead of self._current_state.append(value)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div></div></details><p>Now the <code>aggregate</code> method does not collect the data but constantly sums it. So the <code>process</code> method can perform yet another operation.
Because <em>MAGDA</em> supports the use of interfaces we may want to transform the aggregated sum to an object of a particular structure. Let&#x27;s implement the simplest version of a class we&#x27;ll call <code>ItemsSum</code>. Our <code>process</code> method might now looks like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> magda</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">module </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Module</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ItemsSum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Interface</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> val</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">sum</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> val</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__repr__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># in order to display the value nicely</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;ItemsSum(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">self</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation builtin">sum</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">)&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">AggregationModule</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Aggregate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">process</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ResultSet</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        state_copy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_current_state</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">clear_state</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> ItemsSum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">state_copy</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">clear_state</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_current_state </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># instead of []</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Our <code>AggregationModule</code> can now pass its output to some other module which would only accept an input that inherits from the <code>ItemsSum</code> class. The output now looks like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Process</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;agg_mod&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ItemsSum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">330</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>We can visualize this example in a diagram as well.</p><svg xmlns="http://www.w3.org/2000/svg" width="50%" height="433" viewBox="-0.5 -0.5 537 433" class="diagram"><defs><style>@import url(https://fonts.googleapis.com/css?family=Roboto);</style></defs><path fill="#f7f7f7" stroke="#ababab" stroke-width="2" pointer-events="all" d="M11 11h510v133H11zM11 150h510v133H11zM11 289h510v133H11z"></path><path d="M396 202h38.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M443.76 202l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M396 342h38.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M443.76 342l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M396 63h38.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M443.76 63l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M126 23h80v80h-80z"></path><path fill="#e1d5e7" stroke="#9673a6" stroke-width="6" pointer-events="all" d="M316 23h80v80h-80z"></path><path fill="none" pointer-events="all" d="M326 103h60v30h-60z"></path><text x="355.5" y="126.5" fill="#765A82" font-family="Roboto" font-weight="bold" text-anchor="middle" font-size="20">(Agg)</text><path d="M76 63h38.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M123.76 63l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="none" pointer-events="all" d="M20 395h140v20H20z"></path><text x="21.5" y="411.5" fill="#999" font-family="Roboto" font-weight="bold" font-size="16">pipeline.process()</text><circle cx="47" cy="63" fill="#f8cecc" stroke="#b85450" stroke-width="2" pointer-events="all" r="21"></circle><text x="46.5" y="69.5" font-family="Roboto" text-anchor="middle" font-size="16">10</text><ellipse cx="166" cy="63" rx="32.5" ry="20" fill="#f8cecc" stroke="#b85450" stroke-width="2" pointer-events="all"></ellipse><text x="165.5" y="69.5" font-family="Roboto" text-anchor="middle" font-size="16">10 * 11</text><circle cx="356" cy="62" fill-opacity="0.5" fill="#f8cecc" stroke="#b85450" stroke-opacity="0.5" stroke-width="2" pointer-events="all" r="21"></circle><text x="355.5" y="68.5" font-family="Roboto" text-anchor="middle" font-size="16">110</text><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M126 162h80v80h-80z"></path><path fill="#e1d5e7" stroke="#9673a6" stroke-width="6" pointer-events="all" d="M316 162h80v80h-80z"></path><path fill="none" pointer-events="all" d="M326 242h60v30h-60z"></path><text x="355.5" y="265.5" fill="#765A82" font-family="Roboto" font-weight="bold" text-anchor="middle" font-size="20">(Agg)</text><path d="M76 202h38.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M123.76 202l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><circle cx="47" cy="202" fill="#ffe6cc" stroke="#d79b00" stroke-width="2" pointer-events="all" r="21"></circle><text x="46.5" y="208.5" font-family="Roboto" text-anchor="middle" font-size="16">20</text><ellipse cx="166" cy="202" rx="32.5" ry="20" fill="#ffe6cc" stroke="#d79b00" stroke-width="2" pointer-events="all"></ellipse><text x="165.5" y="208.5" font-family="Roboto" text-anchor="middle" font-size="16">20 * 11</text><circle cx="364" cy="195" fill-opacity="0.5" fill="#f8cecc" stroke="#b85450" stroke-opacity="0.5" stroke-width="2" pointer-events="all" r="21"></circle><text x="363.5" y="201.5" font-family="Roboto" text-anchor="middle" font-size="16" opacity="0.5">110</text><circle cx="350" cy="210" fill-opacity="0.5" fill="#ffe6cc" stroke="#d79b00" stroke-opacity="0.5" stroke-width="2" pointer-events="all" r="21"></circle><text x="349.5" y="216.5" font-family="Roboto" text-anchor="middle" font-size="16" opacity="0.5">220</text><path fill="#fff2cc" stroke="#d6b656" stroke-width="2" pointer-events="all" d="M126 302h80v80h-80z"></path><path fill="#e1d5e7" stroke="#9673a6" stroke-width="6" pointer-events="all" d="M316 302h80v80h-80z"></path><path fill="none" pointer-events="all" d="M326 382h60v30h-60z"></path><text x="355.5" y="405.5" fill="#765A82" font-family="Roboto" font-weight="bold" text-anchor="middle" font-size="20">(Agg)</text><path d="M76 342h38.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M123.76 342l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path fill="none" pointer-events="all" d="M20 255h130v20H20z"></path><text x="21.5" y="271.5" fill="#999" font-family="Roboto" font-weight="bold" font-size="16">pipeline.run(20)</text><path fill="none" pointer-events="all" d="M20 116h130v20H20z"></path><text x="21.5" y="132.5" fill="#999" font-family="Roboto" font-weight="bold" font-size="16">pipeline.run(10)</text><path d="M206 342h98.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M313.76 342l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M206 202h98.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M313.76 202l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><path d="M206 63h98.76" fill="none" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="stroke"></path><path d="M313.76 63l-12 6 3-6-3-6z" stroke="#000" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><circle cx="257" cy="63" fill="#f8cecc" stroke="#b85450" stroke-width="2" pointer-events="all" r="21"></circle><text x="256.5" y="69.5" font-family="Roboto" text-anchor="middle" font-size="16">110</text><circle cx="257" cy="202" fill="#ffe6cc" stroke="#d79b00" stroke-width="2" pointer-events="all" r="21"></circle><text x="256.5" y="208.5" font-family="Roboto" text-anchor="middle" font-size="16">220</text><path d="M439 314h64l11 28-11 28h-64l11-28z" fill-opacity="0.5" fill="#fff" stroke="#4d4d4d" stroke-opacity="0.5" stroke-width="2" stroke-miterlimit="10" pointer-events="all"></path><circle cx="478" cy="342" fill="#e1d5e7" stroke="#9673a6" stroke-width="2" pointer-events="all" r="21"></circle><text x="477.5" y="348.5" font-family="Roboto" text-anchor="middle" font-size="16">330</text><path fill="none" pointer-events="all" d="M436 379h90v20h-90z"></path><text x="437.5" y="395.5" fill="#999" font-family="Roboto" font-weight="bold" font-size="16">ItemsSum</text><path d="M337.25 195.29h13.54v-13.54h13.42v13.54h13.54v13.42h-13.54v13.54h-13.42v-13.54h-13.54zM337.25 54.54h13.54V41h13.42v13.54h13.54v13.42h-13.54V81.5h-13.42V67.96h-13.54z" fill="none" stroke="#2c262e" stroke-width="4" stroke-miterlimit="10" pointer-events="all"></path><path d="M363.83 317l18.67 15.58-18.67 15.59v-8.09c-17.3 0-31.33 12.06-31.33 26.92 0-23.15 14.03-41.91 31.33-41.91z" fill="none" stroke="#333" stroke-width="4" stroke-miterlimit="10" pointer-events="all"></path><path d="M141 317h14.58L166 331.8l10.42-14.8H191l-17.71 25L191 367h-14.58L166 352.2 155.58 367H141l16.67-25z" fill="none" stroke="#333" stroke-opacity="0.5" stroke-width="4" stroke-miterlimit="10" pointer-events="all"></path></svg></div><footer class="docusaurus-mt-lg"><div class="row"><div class="col"><a href="https://github.com/NeuroSYS-pl/magda/edit/main/web/docs/modules/stateful.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/magda/docs/next/modules/interfaces/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ Interfaces</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/magda/docs/next/pipelines/sequential/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Sequential ¬ª</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#pipeline-modes" class="table-of-contents__link">Pipeline modes</a><ul><li><a href="#auxiliary-notions" class="table-of-contents__link">Auxiliary notions</a></li><li><a href="#run-mode" class="table-of-contents__link">Run mode</a></li><li><a href="#process-mode" class="table-of-contents__link">Process mode</a></li></ul></li><li><a href="#exemplary-diagram" class="table-of-contents__link">Exemplary diagram</a></li><li><a href="#moduleaggregate-usage" class="table-of-contents__link"><code>ModuleAggregate</code> usage</a><ul><li><a href="#common-code" class="table-of-contents__link">Common code</a></li><li><a href="#small-simplification" class="table-of-contents__link">Small simplification</a></li></ul></li><li><a href="#example-1---the-original-implementation" class="table-of-contents__link">Example 1 - the original implementation</a><ul><li><a href="#running-the-pipeline-differently" class="table-of-contents__link">Running the pipeline differently</a></li></ul></li><li><a href="#example-2---overriding-the-process-method" class="table-of-contents__link">Example 2 - overriding the <code>process</code> method</a></li><li><a href="#example-3---overriding-both-aggregate-and-process-methods" class="table-of-contents__link">Example 3 - overriding both <code>aggregate</code> and <code>process</code> methods</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://neurosys.com/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_MyFc"><img src="https://neurosys.com/wp-content/themes/neurosys/static/images/logo-white.svg" alt="NeuroSYS" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="https://neurosys.com/wp-content/themes/neurosys/static/images/logo-white.svg" alt="NeuroSYS" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></a></div><div class="footer__copyright">Copyright ¬© 2021 NeuroSYS, Built with Docusaurus.</div></div></div></footer></div>
<script src="/magda/assets/js/runtime~main.434a9ea3.js"></script>
<script src="/magda/assets/js/main.be521564.js"></script>
</body>
</html>